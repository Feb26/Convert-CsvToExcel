■機能
・CSVファイルを、Excelファイルに変換します
・すべてのデータはテキストとして読み込まれます（日付や数値としては読み込まれません）
・シート名には元のファイル名が設定されます
	・元のファイル名にシート名に設定できない文字が含まれる、または32文字を超過している場合、デフォルト値(Sheet1)のままとなります
・各入力ファイルの文字エンコーディングと改行コードは自動的に判別されます



■使用方法
以下のA、Bいずれかの方法で変換できます。

A. ドラッグアンドドロップ(D&D)したファイルを変換する
	1. run.batにファイルやディレクトリを選択してD&Dする
		・複数ファイルを同時にD&Dできます
	2. D&Dしたのがディレクトリの場合、表示されたビューを使用して、変換するファイルを選択する
		・ファイルの場合、自動的に変換し、outputディレクトリに出力されます
	3. OKボタンを押下する
		・outputディレクトリに出力されます

B. inputディレクトリ配下のファイルを変換する
	1. inputディレクトリに変換したいファイルやファイルを含むディレクトリをコピーする
	2. run.batをダブルクリックする
	3. 表示されたビューを使用して、変換するファイルを選択する
	4. OKボタンを押下する
		・inputディレクトリの構造を保ったままoutputディレクトリに出力されます



■設定
・設定値はsettings.jsonで変更可能です
・初期値は以下のようになっています

{
	"inputFile": {
		"extension": "*",
		"delimiter": ",",
		"textQualifier": "\""
	},

	"outputFile": {
		"font": "ＭＳ Ｐゴシック",
		"adjustColumnWidth": true
	},

	"path": {
		"inputDir": ".\\input",
		"outputDir": ".\\output"
	}
}

| 項目              | 説明                                                 | 例                                       |
| :---------------- | :--------------------------------------------------- | :--------------------------------------- |
| extension         | 入力ファイルの拡張子を指定します。                   | "*"  "csv"  "tsv"  "txt"                 |
| delimiter         | 入力ファイルの区切り文字を指定します。               | ","  ";"  "\t"                           |
| textQualifier     | 入力ファイルの文字列の囲み文字を指定します。         | "\""  "'"                                |
| font              | 出力ファイルのブックのフォントを指定します。※1      | "ＭＳ　Ｐゴシック"  "Tahoma"  "Consolas" |
| adjustColumnWidth | 出力ファイルの列幅を調節する場合trueを指定します。   | true  false                              |
| inputDir          | 入力ファイルのルートディレクトリのパスを指定します。 | "C:\\test\\input"                        |
| outputDir         | 出力ファイルのルートディレクトリのパスを指定します。 | "C:\\test\\output"                       |

※1 フォントについて
	・実行環境にインストールされているフォント名を指定してください
	・PowerShellにて下記コマンドを実行すると、フォント名の一覧を確認することができます
	・[void][reflection.assembly]::LoadWithPartialName("System.Drawing");[System.Drawing.FontFamily]::Families



■ディレクトリ構成
./
|-- 
|-- input                                    使用方法Bで入力ファイルを置くディレクトリ
|-- lib                                      使用しているライブラリのdllなどを格納するディレクトリ
|-- output                                   出力ファイルのExcelを出力するディレクトリ
|-- src                                      ソースコードを格納するディレクトリ
|   |-- Convert-AllCsvInInputDir2Excel.ps1   使用方法Bのソースコード
|   |-- Convert-AllCsvOfArgs2Excel.ps1       使用方法Aのソースコード
|   |-- Convert-Csv2Excel.ps1                CSVをExcelに変換する処理のコード
|   `-- Resolve-Encoding.ps1                 文字エンコーディングの自動判定処理のコード
|-- log.txt                                  ログファイル
|-- readme.txt                               本ファイル
|-- run.bat                                  起動に使用するファイル
`-- settings.json                            設定ファイル



■動作確認環境
| Software                 | Ver.           |
| :----------------------- | :------------- |
| Windows 10 Enterprise    | 1709           |
| PowerShell               | 5.1.16299.1004 |
| .NET Framework           | 4.5            |



■使用ライブラリ
| Name        | Ver.       | Path                                                                   |
| :---------- | :--------- | :--------------------------------------------------------------------- |
| EPPlus      | 4.5.3.1    | https://www.nuget.org/packages/EPPlus/                                 |



■変更履歴
| Ver.  | 変更内容                                                                                  |
| :---- | :---------------------------------------------------------------------------------------- |
| 1.0   | 新規作成                                                                                  |
| 1.1   | Comオブジェクトの解放漏れによるプロセス未終了問題の改善                                   |
| 1.2   | D&Dによる変換機能の追加                                                                   |
| 1.3   | UTF-8対応                                                                                 |
| 1.4   | UNC対応                                                                                   |
| 1.5   | Excelのプロセスが残ってしまった場合にをKillする方法の改善                                 |
| 1.6   | COMオブジェクト解放処理を追加しプロセスKill処理を削除                                     |
| 1.7   | 文字エンコーディングの自動判定機能を追加                                                  |
| 1.8   | ディレクトリ構造の変更、D&D時の速度改善                                                   |
| 2.0   | Microsoft.Office.Interop.ExcelからEPPlusに変更、設定項目の追加（改行コードなど）          |
| 2.1   | 改行コードの自動判定機能を追加                                                            |
| 2.2   | ログ出力機能の追加                                                                        |
| 2.2.1 | シート名の設定に失敗した際のハンドリングのデグレ修正                                      |